<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: watchdog.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">watchdog.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;csignal&gt;</code><br />
<code>#include &lt;sstream&gt;</code><br />
<code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;sys/wait.h&gt;</code><br />
</div>
<p><a href="watchdog_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a53bd535ac03b3b92ca1a9570f29c5030"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="watchdog_8cpp.html#a53bd535ac03b3b92ca1a9570f29c5030">exit_signal</a> (int sig)</td></tr>
<tr class="separator:a53bd535ac03b3b92ca1a9570f29c5030"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="watchdog_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af085220f6c5b6f1ed79e54f8adc7610e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="watchdog_8cpp.html#af085220f6c5b6f1ed79e54f8adc7610e">processNum</a></td></tr>
<tr class="separator:af085220f6c5b6f1ed79e54f8adc7610e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a725f40dde867526fdb20dc6794861022"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="watchdog_8cpp.html#a725f40dde867526fdb20dc6794861022">process_output</a></td></tr>
<tr class="separator:a725f40dde867526fdb20dc6794861022"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06afad35bee65399ad75378cda89dd54"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="watchdog_8cpp.html#a06afad35bee65399ad75378cda89dd54">watchdog_output</a></td></tr>
<tr class="separator:a06afad35bee65399ad75378cda89dd54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32b2c07bf2f64897de048c86e709760f"><td class="memItemLeft" align="right" valign="top">struct timespec&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="watchdog_8cpp.html#a32b2c07bf2f64897de048c86e709760f">delta</a> = {0 , 300000000 }</td></tr>
<tr class="separator:a32b2c07bf2f64897de048c86e709760f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a53bd535ac03b3b92ca1a9570f29c5030"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53bd535ac03b3b92ca1a9570f29c5030">&#9670;&nbsp;</a></span>exit_signal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void exit_signal </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sig</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="watchdog_8cpp_source.html#l00021">21</a> of file <a class="el" href="watchdog_8cpp_source.html">watchdog.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;                         {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    ofstream watchdog_output_file; <span class="comment">// Out stream object for writing watchdog output to file.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    watchdog_output_file.open(<a class="code" href="watchdog_8cpp.html#a06afad35bee65399ad75378cda89dd54">watchdog_output</a>,ios::app);    <span class="comment">// Opening the stream object. </span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    watchdog_output_file &lt;&lt; <span class="stringliteral">&quot;Watchdog is terminating gracefully&quot;</span> &lt;&lt; endl;   <span class="comment">// Writing the output to the file. </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    watchdog_output_file.close();   <span class="comment">// Closing stream to prevent inconvinient results. </span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    exit(sig);  <span class="comment">// Exits program when it gets SIGTERM signal.</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div>
<div class="ttc" id="awatchdog_8cpp_html_a06afad35bee65399ad75378cda89dd54"><div class="ttname"><a href="watchdog_8cpp.html#a06afad35bee65399ad75378cda89dd54">watchdog_output</a></div><div class="ttdeci">string watchdog_output</div><div class="ttdef"><b>Definition:</b> <a href="watchdog_8cpp_source.html#l00016">watchdog.cpp:16</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Main part of the program. Process fork's are made in here. First it takes arguments and opens file streams for printing output. Then, it creates the number of processes given in argument. After creating processes it waits for a child to be killed. When a child killed by executor, watchdog detects and reinitialize it. If killed process is the head which is P1 than it kills all the processes first and then reinitialize them. If killed process is not the head, then it first finds which process died and kills the process then reinitialize it. Also watchdog waits for its SIGTERM signal. When it comes, it stop execution and exits the program. </p>
<p>First initializiation of processes.</p>
<p>If pid value equals to zero which means child process call execl function for each process</p>
<p>If pid greater than 0 which means parent and in these case watchdog, it conntinues to create more processes.</p>
<p>While prograam execution continue it waits for a SIGTERM call when it gets the signal it creates new processes for killed ones.</p>
<p>If died process is P1 which is head than kill all other processes and create P1 again</p>
<p>For killing other processes.</p>
<p>Forking new processes to replace killed ones from watchdog.</p>
<p>If pid value equals to zero which means child process call execl function for each process.</p>
<p>If died process is other than P1 create P&lt;x&gt; again</p>
<p>This for finds which process was killed and replace it with new process by using fork.</p>
<p>Finds the index of the killed process.</p>
<p>If pid value equals to zero which means child process call execl function for each process.</p>

<p class="definition">Definition at line <a class="el" href="watchdog_8cpp_source.html#l00035">35</a> of file <a class="el" href="watchdog_8cpp_source.html">watchdog.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                                {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="watchdog_8cpp.html#af085220f6c5b6f1ed79e54f8adc7610e">processNum</a> = stoi(argv[1]);         <span class="comment">// Getting process number from command line argument.</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="watchdog_8cpp.html#a725f40dde867526fdb20dc6794861022">process_output</a> = argv[2];           <span class="comment">// Getting process output file&#39;s path from argument.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="watchdog_8cpp.html#a06afad35bee65399ad75378cda89dd54">watchdog_output</a> = argv[3];          <span class="comment">// Getting watchdog output file&#39;s path from argument.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    pid_t pidArray[<a class="code" href="watchdog_8cpp.html#af085220f6c5b6f1ed79e54f8adc7610e">processNum</a>+1] = {};  <span class="comment">// Creating pid_t array for storing pid values of processes.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    ofstream watchdog_output_file;      <span class="comment">// Out stream object for writing watchdog output to file.</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    watchdog_output_file.open(<a class="code" href="watchdog_8cpp.html#a06afad35bee65399ad75378cda89dd54">watchdog_output</a>); <span class="comment">// Opening the stream object.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    ofstream process_output_file;<span class="comment">// I used this initialization for clearing process_output file before each execution else open(ios::app) causes a problem.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    process_output_file.open (<a class="code" href="watchdog_8cpp.html#a725f40dde867526fdb20dc6794861022">process_output</a>); <span class="comment">// Opening the stream object.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    pid_t watchdog_pid = getpid();  <span class="comment">// Getting watcdog pid value.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    pidArray[0] = watchdog_pid;     <span class="comment">// Adding the pid of watcdog to 0 index of the array.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">string</span> w_info = <span class="stringliteral">&quot;P0 &quot;</span> + to_string(watchdog_pid);    <span class="comment">// Concatenation of P0 and &lt;pid_value&gt;.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">char</span>* watchdog_pid_info = (<span class="keywordtype">char</span>*) w_info.c_str();   <span class="comment">// To giving the appropriate parameter type I changed the type to char.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">int</span> newPp = open(<span class="stringliteral">&quot;/tmp/myfifo&quot;</span>,O_WRONLY);           <span class="comment">// Opening the named pipe.</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    write(newPp,watchdog_pid_info,strlen(watchdog_pid_info)+1); <span class="comment">// Writing the pid value to pipe.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    pid_t childpid; <span class="comment">// Holds the pid values of newly forked processes.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code" href="watchdog_8cpp.html#af085220f6c5b6f1ed79e54f8adc7610e">processNum</a>; i++){</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">if</span>((childpid = fork()) == 0){</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            <span class="keywordtype">char</span>* index = (<span class="keywordtype">char</span>*) to_string(i).c_str();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keywordtype">char</span>* out_process = (<span class="keywordtype">char</span>*) <a class="code" href="watchdog_8cpp.html#a725f40dde867526fdb20dc6794861022">process_output</a>.c_str(); <span class="comment">// Converting string to char for passing right argument to the function.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            execl(<span class="stringliteral">&quot;./process&quot;</span>,<span class="stringliteral">&quot;process&quot;</span>,index,out_process,NULL);    <span class="comment">// Process initialization.</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(childpid &gt; 0){</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            pidArray[i] = childpid; <span class="comment">// Holding the pids of processes.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            watchdog_output_file &lt;&lt; <span class="stringliteral">&quot;P&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; is started and it has a pid of &quot;</span> &lt;&lt; childpid &lt;&lt; endl;<span class="comment">// Printing output file the status.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keywordtype">string</span> p_info = <span class="stringliteral">&quot;P&quot;</span> + to_string(i) + <span class="charliteral">&#39; &#39;</span> + to_string(childpid); <span class="comment">// String concatenation.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="keywordtype">char</span>* process_pid_info = (<span class="keywordtype">char</span>*) p_info.c_str();                <span class="comment">// Changing the type to char. </span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            nanosleep(&amp;<a class="code" href="watchdog_8cpp.html#a32b2c07bf2f64897de048c86e709760f">delta</a>,&amp;<a class="code" href="watchdog_8cpp.html#a32b2c07bf2f64897de048c86e709760f">delta</a>);                                       <span class="comment">// To prevent mixed execution.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            write(newPp,process_pid_info,strlen(process_pid_info)+1);       <span class="comment">// Sends the pid information to executor.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    signal(SIGTERM,<a class="code" href="watchdog_8cpp.html#a53bd535ac03b3b92ca1a9570f29c5030">exit_signal</a>);<span class="comment">// When the instruction.txt file read completely and watchdog kill signal sends it prints necessary statement and exits program.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    pid_t returned_pid; <span class="comment">// It holds the pid values for killed processes.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">while</span>(<span class="keyword">true</span>){</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        returned_pid = wait(NULL);  <span class="comment">// If a precess dies it returns the pid value to returned_pid.</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">if</span>(returned_pid == pidArray[1]){</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            watchdog_output_file &lt;&lt; <span class="stringliteral">&quot;P1 is killed, all processes must be killed\nRestarting all processes&quot;</span> &lt;&lt; endl; <span class="comment">// Printing output file the status.</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"></span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 2; i &lt;= <a class="code" href="watchdog_8cpp.html#af085220f6c5b6f1ed79e54f8adc7610e">processNum</a>; i++){</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                kill(pidArray[i],SIGTERM);  <span class="comment">// Kills processes with SIGTERM signal.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                nanosleep(&amp;<a class="code" href="watchdog_8cpp.html#a32b2c07bf2f64897de048c86e709760f">delta</a>,&amp;<a class="code" href="watchdog_8cpp.html#a32b2c07bf2f64897de048c86e709760f">delta</a>);   <span class="comment">// To prevent mixed execution.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code" href="watchdog_8cpp.html#af085220f6c5b6f1ed79e54f8adc7610e">processNum</a>; i++){</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <span class="keywordflow">if</span>((childpid = fork()) == 0){</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                    <span class="keywordtype">char</span>* index = (<span class="keywordtype">char</span>*) to_string(i).c_str();</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                    <span class="keywordtype">char</span>* out_process = (<span class="keywordtype">char</span>*) <a class="code" href="watchdog_8cpp.html#a725f40dde867526fdb20dc6794861022">process_output</a>.c_str(); <span class="comment">// Converting string to char for passing right argument to the function.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                    execl(<span class="stringliteral">&quot;./process&quot;</span>,<span class="stringliteral">&quot;process&quot;</span>,index,out_process,NULL);    <span class="comment">// Process initialization.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                <span class="comment">/* If pid greater than 0 which means parent and in these case watchdog it conntinues to create more processes. */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(childpid &gt; 0){</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                    pidArray[i] = childpid; <span class="comment">// Holding the pids of processes.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                    watchdog_output_file &lt;&lt; <span class="stringliteral">&quot;P&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; is started and it has a pid of &quot;</span> &lt;&lt; childpid &lt;&lt; endl;<span class="comment">// Printing output file the status.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                    <span class="keywordtype">string</span> p_info = <span class="stringliteral">&quot;P&quot;</span> + to_string(i) + <span class="charliteral">&#39; &#39;</span> + to_string(childpid); <span class="comment">// String concatenation.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                    <span class="keywordtype">char</span>* process_pid_info = (<span class="keywordtype">char</span>*) p_info.c_str();                <span class="comment">// Changing the type to char. </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                    nanosleep(&amp;<a class="code" href="watchdog_8cpp.html#a32b2c07bf2f64897de048c86e709760f">delta</a>,&amp;<a class="code" href="watchdog_8cpp.html#a32b2c07bf2f64897de048c86e709760f">delta</a>);                                       <span class="comment">// To prevent mixed execution.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                    write(newPp,process_pid_info,strlen(process_pid_info)+1);       <span class="comment">// Sends the pid information to executor.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b = 2; b &lt;= <a class="code" href="watchdog_8cpp.html#af085220f6c5b6f1ed79e54f8adc7610e">processNum</a>; b++){</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                <span class="keywordflow">if</span>(returned_pid == pidArray[b]){</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                    watchdog_output_file &lt;&lt; <span class="stringliteral">&quot;P&quot;</span> &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot; is killed\n&quot;</span> &lt;&lt; <span class="stringliteral">&quot;Restarting P&quot;</span> &lt;&lt; b &lt;&lt; endl;<span class="comment">// Printing output file the status.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"></span>                    <span class="keywordflow">if</span>((childpid = fork()) == 0){</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                        <span class="keywordtype">string</span> strIn = to_string(b);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                        <span class="keywordtype">char</span>* index = (<span class="keywordtype">char</span>*) strIn.c_str();     <span class="comment">// Converting string to char for passing right argument to the function.</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                        <span class="keywordtype">char</span>* out_process = (<span class="keywordtype">char</span>*) <a class="code" href="watchdog_8cpp.html#a725f40dde867526fdb20dc6794861022">process_output</a>.c_str();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                        execl(<span class="stringliteral">&quot;./process&quot;</span>,<span class="stringliteral">&quot;process&quot;</span>,index,out_process,NULL);    <span class="comment">// Process initialization.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                    }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    <span class="comment">/* If pid greater than 0 which means parent and in these case watchdog it conntinues to create more processes. */</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(childpid &gt; 0){</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                        pidArray[b] = childpid; <span class="comment">// Holding the pids of processes.</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                        watchdog_output_file &lt;&lt; <span class="stringliteral">&quot;P&quot;</span> &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot; is started and it has a pid of &quot;</span> &lt;&lt; childpid &lt;&lt; endl; <span class="comment">// Printing output file the status.</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                        <span class="keywordtype">string</span> p_info = <span class="stringliteral">&quot;P&quot;</span> + to_string(b) + <span class="charliteral">&#39; &#39;</span> + to_string(childpid);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                        <span class="keywordtype">char</span>* process_pid_info = (<span class="keywordtype">char</span>*) p_info.c_str();            <span class="comment">// Converting string to char for passing right argument to the function.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                        nanosleep(&amp;<a class="code" href="watchdog_8cpp.html#a32b2c07bf2f64897de048c86e709760f">delta</a>,&amp;<a class="code" href="watchdog_8cpp.html#a32b2c07bf2f64897de048c86e709760f">delta</a>);                                   <span class="comment">// To prevent mixed execution.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                        write(newPp,process_pid_info,strlen(process_pid_info)+1);   <span class="comment">//sends the pid information to executor.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                    }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }    </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div>
<div class="ttc" id="awatchdog_8cpp_html_a32b2c07bf2f64897de048c86e709760f"><div class="ttname"><a href="watchdog_8cpp.html#a32b2c07bf2f64897de048c86e709760f">delta</a></div><div class="ttdeci">struct timespec delta</div><div class="ttdef"><b>Definition:</b> <a href="watchdog_8cpp_source.html#l00016">watchdog.cpp:17</a></div></div>
<div class="ttc" id="awatchdog_8cpp_html_a53bd535ac03b3b92ca1a9570f29c5030"><div class="ttname"><a href="watchdog_8cpp.html#a53bd535ac03b3b92ca1a9570f29c5030">exit_signal</a></div><div class="ttdeci">void exit_signal(int sig)</div><div class="ttdef"><b>Definition:</b> <a href="watchdog_8cpp_source.html#l00021">watchdog.cpp:21</a></div></div>
<div class="ttc" id="awatchdog_8cpp_html_a725f40dde867526fdb20dc6794861022"><div class="ttname"><a href="watchdog_8cpp.html#a725f40dde867526fdb20dc6794861022">process_output</a></div><div class="ttdeci">string process_output</div><div class="ttdef"><b>Definition:</b> <a href="watchdog_8cpp_source.html#l00015">watchdog.cpp:15</a></div></div>
<div class="ttc" id="awatchdog_8cpp_html_af085220f6c5b6f1ed79e54f8adc7610e"><div class="ttname"><a href="watchdog_8cpp.html#af085220f6c5b6f1ed79e54f8adc7610e">processNum</a></div><div class="ttdeci">int processNum</div><div class="ttdef"><b>Definition:</b> <a href="watchdog_8cpp_source.html#l00014">watchdog.cpp:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a32b2c07bf2f64897de048c86e709760f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32b2c07bf2f64897de048c86e709760f">&#9670;&nbsp;</a></span>delta</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct timespec delta = {0 , 300000000 }</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>0.3 sec </p>

<p class="definition">Definition at line <a class="el" href="watchdog_8cpp_source.html#l00016">16</a> of file <a class="el" href="watchdog_8cpp_source.html">watchdog.cpp</a>.</p>

</div>
</div>
<a id="a725f40dde867526fdb20dc6794861022"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a725f40dde867526fdb20dc6794861022">&#9670;&nbsp;</a></span>process_output</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string process_output</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Path of the process output file </p>

<p class="definition">Definition at line <a class="el" href="watchdog_8cpp_source.html#l00015">15</a> of file <a class="el" href="watchdog_8cpp_source.html">watchdog.cpp</a>.</p>

</div>
</div>
<a id="af085220f6c5b6f1ed79e54f8adc7610e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af085220f6c5b6f1ed79e54f8adc7610e">&#9670;&nbsp;</a></span>processNum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int processNum</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of processes </p>

<p class="definition">Definition at line <a class="el" href="watchdog_8cpp_source.html#l00014">14</a> of file <a class="el" href="watchdog_8cpp_source.html">watchdog.cpp</a>.</p>

</div>
</div>
<a id="a06afad35bee65399ad75378cda89dd54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06afad35bee65399ad75378cda89dd54">&#9670;&nbsp;</a></span>watchdog_output</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string watchdog_output</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Path of the watcgog output file </p>

<p class="definition">Definition at line <a class="el" href="watchdog_8cpp_source.html#l00016">16</a> of file <a class="el" href="watchdog_8cpp_source.html">watchdog.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.0
</small></address>
</body>
</html>
